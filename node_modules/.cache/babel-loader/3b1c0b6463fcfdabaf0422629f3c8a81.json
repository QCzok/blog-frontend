{"ast":null,"code":"import _regeneratorRuntime from\"/home/dci/Desktop/blog/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/dci/Desktop/blog/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/dci/Desktop/blog/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/dci/Desktop/blog/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import{Redirect}from\"react-router-dom\";import Quill from\"react-quill\";var axios=require(\"axios\").default;var PostForm=function PostForm(_ref){var propsPost=_ref.post,addNewPost=_ref.addNewPost,updatePost=_ref.updatePost;var _useState=useState(_objectSpread({},propsPost)),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),saved=_useState4[0],setSaved=_useState4[1];var prevPostRef=useRef();useEffect(function(){prevPostRef.current=post;},[post]);var prevPost=prevPostRef.current;var quillRef=React.useRef();useEffect(function(){if(prevPost&&quillRef.current){if(propsPost.id!==prevPost.id){setPost(_objectSpread({},propsPost));quillRef.current.getEditor().setContents(\"\");}}},[prevPost,propsPost]);//-----------------------------------------\n/*const addNewPost = async () => {\n    try {\n      axios\n        .get(\"http://localhost:3001/posts\")\n        .then((resp) => setPost(resp.data));\n    } catch (error) {\n      //catching rejected requests\n      console.log(error);\n    }\n  };*/ //---------------------------------------\nvar handlePostForm=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();if(!post.title){_context.next=8;break;}if(updatePost){updatePost(post);}else{addNewPost(post);}setSaved(true);_context.next=6;return axios.put(\"http://localhost:3001/posts\",post);case 6:_context.next=9;break;case 8:alert(\"Title required\");case 9:console.log(post);case 10:case\"end\":return _context.stop();}}},_callee);}));return function handlePostForm(_x){return _ref2.apply(this,arguments);};}();if(saved===true){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}return/*#__PURE__*/React.createElement(\"form\",{className:\"container\",onSubmit:handlePostForm},/*#__PURE__*/React.createElement(\"h1\",null,\"Add a New Post\"),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"form-title\"},\"Title:\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{defaultValue:post.title,id:\"form-title\",value:post.title,onChange:function onChange(event){return setPost(_objectSpread(_objectSpread({},post),{},{title:event.target.value}));}})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"form-content\"},\"Content:\")),/*#__PURE__*/React.createElement(Quill,{ref:quillRef,defaultValue:post.content,onChange:function onChange(content,delta,source,editor){setPost(_objectSpread(_objectSpread({},post),{},{content:editor.getContents()}));}}),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Save\")));};export default PostForm;","map":{"version":3,"sources":["/home/dci/Desktop/blog/Frontend/src/components/PostForm.js"],"names":["React","useState","useEffect","useRef","Redirect","Quill","axios","require","default","PostForm","propsPost","post","addNewPost","updatePost","setPost","saved","setSaved","prevPostRef","current","prevPost","quillRef","id","getEditor","setContents","handlePostForm","event","preventDefault","title","put","alert","console","log","target","value","content","delta","source","editor","getContents"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport Quill from \"react-quill\";\n\nconst axios = require(\"axios\").default;\n\nconst PostForm = ({ post: propsPost, addNewPost, updatePost }) => {\n  const [post, setPost] = useState({ ...propsPost });\n  const [saved, setSaved] = useState(false);\n\n  const prevPostRef = useRef();\n  useEffect(() => {\n    prevPostRef.current = post;\n  }, [post]);\n  const prevPost = prevPostRef.current;\n\n  const quillRef = React.useRef();\n  useEffect(() => {\n    if (prevPost && quillRef.current) {\n      if (propsPost.id !== prevPost.id) {\n        setPost({ ...propsPost });\n        quillRef.current.getEditor().setContents(``);\n      }\n    }\n  }, [prevPost, propsPost]);\n\n//-----------------------------------------\n  /*const addNewPost = async () => {\n    try {\n      axios\n        .get(\"http://localhost:3001/posts\")\n        .then((resp) => setPost(resp.data));\n    } catch (error) {\n      //catching rejected requests\n      console.log(error);\n    }\n  };*/\n//---------------------------------------\n\n\n  const handlePostForm = async (event) => {\n    event.preventDefault();\n    if (post.title) {\n      if (updatePost) {\n        updatePost(post);\n      } else {\n        addNewPost(post);\n      }\n      setSaved(true);\n      await axios.put(\"http://localhost:3001/posts\", post)\n      //window.location.replace(\"/\")\n    } else {\n      alert(\"Title required\");\n    }\n    console.log(post);\n  };\n\n\n  \n\n  if (saved === true) {\n    return <Redirect to=\"/\" />;\n  }\n  return (\n    <form className=\"container\" onSubmit={handlePostForm}>\n      <h1>Add a New Post</h1>\n      <p>\n        <label htmlFor=\"form-title\">Title:</label>\n        <br />\n        <input\n          defaultValue={post.title}\n          id=\"form-title\"\n          value={post.title}\n          onChange={(event) =>\n            setPost({\n              ...post,\n              title: event.target.value,\n            })\n          }\n        />\n      </p>\n      <p>\n        <label htmlFor=\"form-content\">Content:</label>\n      </p>\n      <Quill\n        ref={quillRef}\n        defaultValue={post.content}\n        onChange={(content, delta, source, editor) => {\n          setPost({\n            ...post,\n            content: editor.getContents(),\n          });\n        }}\n      />\n      <p>\n        <button type=\"submit\">Save</button>\n      </p>\n    </form>\n  );\n};\nexport default PostForm;\n"]},"metadata":{},"sourceType":"module"}